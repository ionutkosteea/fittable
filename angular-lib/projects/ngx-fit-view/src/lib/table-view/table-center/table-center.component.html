<div class="table-center" [ngStyle]="getTableOffset()">
  <table class="table">
    <colgroup>
      <col *ngFor="let colId of getColIds()" [ngStyle]="{'width.px':getColWidth(colId)}" />
    </colgroup>
    <tbody (contextmenu)="showContextMenu($event)" fitCellEditorOpen [cellEditorListener]="cellEditorListener"
      fitCellSelection [cellSelectionListener]="cellSelectionListener" [cellSelectionRanges]="getCellSelectionRanges()">
      <tr *ngFor="let rowId of getRowIds()" [ngStyle]="{'height.px':getRowHeight(rowId)}">
        <ng-container *ngFor="let colId of getColIds()">
          <td class="cell" *ngIf="!isHiddenCell(rowId,colId)" [ngStyle]="getCellStyle(rowId,colId)"
            [rowSpan]="getRowSpan(rowId,colId)" [colSpan]="getColSpan(rowId,colId)" [attr.rowId]="rowId"
            [attr.colId]="colId">
            <p class="cell-text">{{getCellValue(rowId, colId)}}</p>
          </td>
        </ng-container>
      </tr>
    </tbody>
  </table>
</div>
<div class="cell-selection" *ngFor="let rect of getCellSelectionRectangles()" [ngStyle]="rect"></div>
<fit-cell-editor *ngIf="cellEditorListener !== undefined" [cellEditorListener]="cellEditorListener"
  [getCellStyle]="getCellStyle"></fit-cell-editor>